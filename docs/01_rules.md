# n8n 文件分析與系統架構自動化流程－全域規範（Rules）

> 本文件為《00_vibe.md》的補充規範文件。  
> 所有 n8n 流程與 LLM 分析行為，皆必須同時遵守本文件與 00_vibe.md。  
> 若有衝突，以本文件之規範為準。

---

## 1. 規範適用範圍（Scope）

本規範適用於：

- n8n 中所有自動化流程
- 所有文件分析相關的 LLM 呼叫（Gemini / OpenAI / 其他）
- 所有由系統自動產出的 Markdown 文件

---

## 2. LLM 行為規範（Model Behavior Rules）

### 2.1 資訊來源限制

- LLM **僅能根據使用者提供的文件內容進行分析**
- 不得引入未在文件中出現的系統、模組、流程或角色
- 不得自行補齊缺失的資訊

### 2.2 不確定性處理

- 若文件未提供必要資訊，必須明確標示：
  - `文件未提供`
- 禁止使用模糊推測語句（例如：可能、大概、推測）

### 2.3 禁止行為

- 禁止臆測業務流程
- 禁止假設系統存在特定技術（如資料庫、API、服務）
- 禁止生成與文件分析無關的建議或評論

---

## 3. 分析流程穩定原則（Workflow Invariants）

所有文件分析流程必須遵守以下固定順序：

1. 文件內容解析
2. 結構化摘要（重點、角色、系統元件）
3. 系統架構分析
4. 流程關係整理
5. Mermaid 流程圖產出
6. 最終 Markdown 文件輸出

- 不得跳過任何步驟
- 任一階段失敗時，不得直接產出最終文件

---

## 4. 輸出格式規範（Output Rules）

### 4.1 基本格式

- **僅允許輸出 Markdown**
- 禁止輸出 HTML、JSON 或純文字說明
- 不得夾帶「分析過程說明」或對使用者的對話語句

### 4.2 Markdown 結構要求

- 必須使用標準 Markdown 語法
- 標題階層最多至 `###`
- 清楚分段，不得輸出單一長段落

---

## 5. Mermaid 流程圖規範

- 必須使用標準 Mermaid 語法
- Mermaid 區塊需可直接被解析與渲染
- 節點 ID 必須使用小寫英文或 snake_case
- 流程關係需與文件內容一致，不得自行擴充

---

## 6. 命名與語言規範

- 系統元件名稱：英文 + snake_case
- 流程名稱：英文，語意清楚
- 說明文字可使用中文，但需保持技術中性、不情緒化

---

## 7. 最終產出文件責任

- 所有最終產出的 Markdown 文件，視為系統正式輸出
- 不得包含測試用語、暫時性備註或內部註解
- 產出內容需可作為系統架構文件或設計參考文件使用

---
